(()=>{"use strict";const t=document.getElementById("canvas"),i=t.getContext("2d");function e(t,i,e){const s=new Image;return s.src=t,s.width=i,s.height=e,s}const s="../assets/img/platform.png",o="../assets/img/bg_2.jpg";class r{constructor(){this.position={x:200,y:t.height/2},this.velocity={x:0,y:1},this.width=32,this.height=32,this.frames=0,this.sprites={idle:{right:e("../assets/img/Idle_right.png",32,32),left:e("../assets/img/Idle_left.png",32,32)},run:{right:e("../assets/img/Run_right.png",32,32),left:e("../assets/img/Run_left.png",32,32)},jump:{right:e("../assets/img/Jump_right.png",32,32),left:e("../assets/img/Jump_left.png",32,32)},fall:{right:e("../assets/img/Fall_right.png",32,32),left:e("../assets/img/Fall_left.png",32,32)}},this.currentSprite=this.sprites.idle.right}draw(){i.drawImage(this.currentSprite,32*this.frames,0,32,32,this.position.x,this.position.y,this.width,this.height)}update(){this.frames++,this.frames>21&&(this.frames=0),this.draw(),this.position.y+=this.velocity.y,this.position.x+=this.velocity.x,this.position.y+this.height+this.velocity.y<=t.height&&(this.velocity.y+=.25)}}class h{constructor(t,i,e){this.position={x:t,y:i},this.image=e,this.width=e.width,this.height=e.height}draw(){i.drawImage(this.image,this.position.x,this.position.y)}}t.width=1024,t.height=576;class n{constructor(t,i,e){this.position={x:t,y:i},this.image=e,this.width=e.width,this.height=e.height}draw(){i.drawImage(this.image,this.position.x,this.position.y)}}let p=[new n(0,0,e(o,t.width,t.height))],l=[new h(10,525,e(s,300,54)),new h(300,455,e(s,300,54)),new h(250,400,e(s,300,54)),new h(400,200,e(s,300,54))],g=new r;const d={right:{pressed:!1},left:{pressed:!1},up:{pressed:!1},lastPressed:"right"};function y(){p=[new n(0,0,e(o,t.width,t.height))],l=[new h(10,525,e(s,300,54)),new h(300,455,e(s,300,54)),new h(250,400,e(s,300,54)),new h(400,200,e(s,300,54))],g=new r}y(),function e(){requestAnimationFrame(e),i.fillStyle="white",i.fillRect(0,0,t.width,t.height),console.log("animation counter"),p.forEach((t=>t.draw())),l.forEach((t=>t.draw())),g.update(),d.right.pressed&&g.position.x+g.width<=t.width?g.velocity.x=2:d.left.pressed&&g.position.x>=0?g.velocity.x=-2:g.velocity.x=0,l.forEach((t=>{g.position.y+g.height<=t.position.y&&g.position.y+g.height+g.velocity.y>=t.position.y&&g.position.x+g.width>=t.position.x+g.width/3&&g.position.x<=t.position.x+t.width-g.width/3&&(g.velocity.y=0),g.position.y<=t.position.y+t.height&&g.position.y+g.height+g.velocity.y>=t.position.y&&g.position.x>=t.position.x-g.width/2&&g.position.x+g.width<=t.position.x+t.width+g.width/2&&(g.velocity.y=1),d.right.pressed&&g.position.y+g.height>=t.position.y&&g.position.y<=t.position.y+t.height&&g.position.x+g.width>=t.position.x&&(g.velocity.x=0,console.log("hit!")),d.right.pressed&&g.position.y+g.height>=t.position.y&&g.position.y<=t.position.y+t.height&&g.position.x+g.width>=t.position.x+t.width&&(g.velocity.x=2,console.log("free!")),d.left.pressed&&g.position.y+g.height>=t.position.y&&g.position.y<=t.position.y+t.height&&g.position.x<=t.position.x+t.width&&(g.velocity.x=0,console.log("hit!")),d.left.pressed&&g.position.y+g.height>=t.position.y&&g.position.y<=t.position.y+t.height&&g.position.x+g.width<=t.position.x&&(g.velocity.x=-2,console.log("free!"))})),10!==g.velocity.y||d.right.pressed||d.left.pressed||"right"!==d.lastPressed?10!==g.velocity.y||d.right.pressed||d.left.pressed||"left"!==d.lastPressed||(g.currentSprite=g.sprites.idle.left):g.currentSprite=g.sprites.idle.right,g.position.y>t.height&&(y(),console.log("you lose"))}(),window.addEventListener("keydown",(t=>{if(0==t.repeat)switch(t.code){case"ArrowUp":0===g.velocity.y&&"right"===d.lastPressed?(g.velocity.y-=10,g.currentSprite=g.sprites.jump.right):0===g.velocity.y&&"left"===d.lastPressed&&(g.velocity.y-=10,g.currentSprite=g.sprites.jump.left);break;case"ArrowRight":d.right.pressed=!0,d.lastPressed="right",g.currentSprite=g.sprites.run.right;break;case"ArrowLeft":d.left.pressed=!0,d.lastPressed="left",g.currentSprite=g.sprites.run.left}})),window.addEventListener("keyup",(t=>{if(0==t.repeat)switch(t.code){case"ArrowUp":d.up.pressed=!0,0!==g.velocity.y&&"right"===d.lastPressed?g.currentSprite=g.sprites.fall.right:0!==g.velocity.y&&"left"===d.lastPressed&&(g.currentSprite=g.sprites.fall.left);break;case"ArrowRight":d.right.pressed=!1,g.currentSprite=g.sprites.idle.right;break;case"ArrowLeft":d.left.pressed=!1,g.currentSprite=g.sprites.idle.left}}))})();